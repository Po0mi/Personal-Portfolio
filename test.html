<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MÅNE • Architecture of Silence</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;600;800&display=swap"
      rel="stylesheet"
    />
    <!-- GSAP & ScrollTrigger -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <style>
      /* ---------- CONFIG & VARIABLES (unchanged) ---------- */
      :root {
        --bg: #080808;
        --text-muted: #444;
        --text-light: #e5e5e5;
        --accent: #d4c5a3;
        /* keep timeline-scope for original CSS (non-GSAP fallback) */
        timeline-scope: --s1, --s2, --s3, --s4, --s5, --s6;
      }

      /* Base / Reset */
      body {
        margin: 0;
        background: var(--bg);
        color: var(--text-light);
        font-family: "Manrope", sans-serif;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
      }

      /* Layout: Sticky Visuals (Right) */
      .sticky-visual {
        position: fixed;
        top: 0;
        right: 0;
        width: 50%;
        height: 100vh;
        display: grid;
        place-items: center;
        z-index: 10;
        pointer-events: none;
        border-left: 1px solid rgba(255, 255, 255, 0.05);
      }

      /* CRITICAL FIX: Ensure shapes never overlap */
      .shape-container {
        position: absolute;
        width: 400px;
        height: 400px;
        display: grid;
        place-items: center;
        opacity: 0; /* start hidden */
        visibility: hidden; /* fully hidden, not taking up mouse events but also not overlapping invisibly */
        transform: translateY(40px) scale(0.9);
        transition:
          visibility 0.2s,
          opacity 0.2s; /* smooth crossfade helper */
        pointer-events: none;
        will-change: opacity, visibility, transform;
      }

      /* override visibility when opacity becomes 1 via GSAP - we use GSAP to set visibility to visible */
      .shape-container.visible {
        visibility: visible;
      }

      /* Layout: Content (Left) – unchanged */
      .content {
        width: 50%;
        padding-bottom: 20vh;
        position: relative;
        z-index: 20;
      }

      header {
        height: 90vh;
        display: flex;
        align-items: center;
        padding-left: 10vw;
      }

      .scroll-section {
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding-left: 10vw;
        padding-right: 2rem;
      }

      .closing-section {
        height: 60vh;
        display: flex;
        align-items: center;
        padding-left: 10vw;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        margin-top: 10vh;
      }

      /* ---------- TYPOGRAPHY ---------- */
      h1 {
        font-size: 1.5rem;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        font-weight: 300;
        margin: 0;
        color: var(--accent);
        opacity: 0.8;
      }

      .title-large {
        display: block;
        font-size: 5rem;
        font-weight: 800;
        letter-spacing: -0.02em;
        color: var(--text-light);
        margin-top: 1rem;
        line-height: 1;
      }

      .focus-text {
        font-size: 3.5rem;
        font-weight: 600;
        line-height: 1.1;
        color: var(--text-muted);
        margin: 0;
        max-width: 500px;
        letter-spacing: -0.02em;
        /* base state for GSAP in/out blur */
        opacity: 0;
        filter: blur(12px);
        transform: scale(0.8) translateY(40px);
      }

      .description {
        font-size: 1.1rem;
        color: #666;
        margin-top: 1.5rem;
        max-width: 420px;
        line-height: 1.7;
        font-weight: 300;
        border-left: 2px solid transparent;
        padding-left: 1.5rem;
        opacity: 0;
        filter: blur(12px);
        transform: scale(0.8) translateY(40px);
      }

      .closer {
        font-size: 1.2rem;
        font-weight: 300;
        color: var(--text-muted);
      }
      .closer strong {
        display: block;
        font-size: 2rem;
        color: var(--text-light);
        margin-bottom: 1rem;
      }

      /* ---------- CSS SHAPES (unchanged) ---------- */
      .circle-outline {
        width: 300px;
        height: 300px;
        border: 2px solid var(--text-light);
        border-radius: 50%;
        box-shadow: 0 0 60px rgba(255, 255, 255, 0.05);
      }

      .stone-block {
        width: 250px;
        height: 350px;
        background: linear-gradient(135deg, #333, #111);
        border-radius: 4px;
        position: relative;
        overflow: hidden;
      }
      .stone-block::after {
        content: "";
        position: absolute;
        inset: 0;
        background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.4'/%3E%3C/svg%3E");
        mix-blend-mode: overlay;
      }

      .grid-lines {
        width: 300px;
        height: 300px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        gap: 20px;
      }
      .grid-box {
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .grid-box:nth-child(1) {
        border-top: 0;
        border-left: 0;
      }
      .grid-box:nth-child(4) {
        border-bottom: 0;
        border-right: 0;
      }

      .balance {
        width: 300px;
        height: 300px;
        position: relative;
      }
      .b-circle {
        position: absolute;
        width: 150px;
        height: 150px;
        border-radius: 50%;
        mix-blend-mode: exclusion;
      }
      .b-1 {
        background: #fff;
        top: 20%;
        left: 20%;
      }
      .b-2 {
        background: #666;
        bottom: 20%;
        right: 20%;
      }

      .light-orb {
        width: 300px;
        height: 300px;
        border-radius: 50%;
        background: radial-gradient(
          circle at 30% 30%,
          var(--accent),
          transparent 60%
        );
        filter: blur(40px);
        opacity: 0.6;
      }

      .end-line {
        width: 2px;
        height: 300px;
        background: var(--text-light);
        position: relative;
      }
      .end-line::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40px;
        height: 1px;
        background: var(--text-light);
      }

      /* ---------- PROGRESS (pure CSS, functional, untouched) ---------- */
      .desktop-progress {
        position: absolute;
        left: -1px;
        top: 0;
        width: 3px;
        height: 100%;
        background: var(--accent);
        transform-origin: top;
        transform: scaleY(0);
        animation: progress-grow linear;
        animation-timeline: scroll();
        z-index: 20;
      }

      .mobile-progress {
        display: none;
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        z-index: 100;
        background: rgba(0, 0, 0, 0.8);
        border-radius: 50%;
        padding: 5px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
      }

      .mobile-progress svg {
        width: 100%;
        height: 100%;
        transform: rotate(-90deg);
      }

      .progress-circle {
        fill: none;
        stroke: var(--accent);
        stroke-width: 8;
        stroke-linecap: round;
        stroke-dasharray: 1;
        stroke-dashoffset: 1;
        animation: circle-grow linear;
        animation-timeline: scroll();
      }

      .track-circle {
        fill: none;
        stroke: rgba(255, 255, 255, 0.1);
        stroke-width: 8;
      }

      @keyframes progress-grow {
        to {
          transform: scaleY(1);
        }
      }
      @keyframes circle-grow {
        to {
          stroke-dashoffset: 0;
        }
      }

      /* responsive – same */
      @media (max-width: 768px) {
        .sticky-visual {
          opacity: 0.1;
          width: 100%;
          z-index: -1;
          border-left: none;
        }
        .content {
          width: 100%;
        }
        .scroll-section,
        header {
          padding-left: 1.5rem;
        }
        .focus-text {
          font-size: 2rem;
        }
        .title-large {
          font-size: 3.5rem;
        }
        .desktop-progress {
          display: none;
        }
        .mobile-progress {
          display: block;
        }
      }
    </style>
  </head>
  <body>
    <!-- Mobile Progress Widget (unchanged) -->
    <div class="mobile-progress">
      <svg viewBox="0 0 100 100">
        <circle class="track-circle" cx="50" cy="50" r="40" />
        <circle class="progress-circle" cx="50" cy="50" r="40" pathLength="1" />
      </svg>
    </div>

    <!-- Visuals Container (shapes) – ABSOLUTELY NO OVERLAP: only one shape visible at a time -->
    <div class="sticky-visual">
      <div class="desktop-progress"></div>

      <div class="shape-container shape-1">
        <div class="circle-outline"></div>
      </div>
      <div class="shape-container shape-2">
        <div class="stone-block"></div>
      </div>
      <div class="shape-container shape-3">
        <div class="grid-lines">
          <div class="grid-box"></div>
          <div class="grid-box"></div>
          <div class="grid-box"></div>
          <div class="grid-box"></div>
        </div>
      </div>
      <div class="shape-container shape-4">
        <div class="balance">
          <div class="b-circle b-1"></div>
          <div class="b-circle b-2"></div>
        </div>
      </div>
      <div class="shape-container shape-5">
        <div class="light-orb"></div>
      </div>
      <div class="shape-container shape-6">
        <div class="end-line"></div>
      </div>
    </div>

    <!-- Scroll Content -->
    <div class="content">
      <header>
        <div>
          <h1>MÅNE Studio</h1>
          <span class="title-large">Architecture<br />of Silence.</span>
        </div>
      </header>

      <section class="scroll-section s1" id="s1">
        <p class="focus-text">We don't just fill space. We shape the void.</p>
        <p class="description">
          True luxury is the absence of noise. Our design philosophy centers on
          negative space as the primary material of construction.
        </p>
      </section>

      <section class="scroll-section s2" id="s2">
        <p class="focus-text">Honest materials that age, but never break.</p>
        <p class="description">
          Raw oak. Brushed steel. Travertine stone. We select materials that
          develop a patina, telling the story of their use over decades.
        </p>
      </section>

      <section class="scroll-section s3" id="s3">
        <p class="focus-text">Rigorous structure. Fluid living.</p>
        <p class="description">
          The grid is our foundation, but life is organic. We create systems
          that bring order to chaos without constraining the human spirit.
        </p>
      </section>

      <section class="scroll-section s4" id="s4">
        <p class="focus-text">Objects that don't scream for attention.</p>
        <p class="description">
          In a world of constant demand, we create calm. Furniture and spaces
          that exist with quiet confidence and absolute purpose.
        </p>
      </section>

      <section class="scroll-section s5" id="s5">
        <p class="focus-text">Light as the fourth dimension.</p>
        <p class="description">
          We sculpt light like a physical material. It guides the eye, reveals
          texture, and marks the passage of time throughout the day.
        </p>
      </section>

      <section class="scroll-section s6" id="s6">
        <p class="focus-text">Sustainability is not a feature.</p>
        <p class="description">
          It is the default. We build for permanence. The most sustainable
          building is the one that never needs to be torn down.
        </p>
      </section>

      <div class="closing-section">
        <div class="closer">
          <strong>Start the conversation.</strong>
          hello@manestudio.com<br />
          Copenhagen / Tokyo / New York
        </div>
      </div>
    </div>

    <script>
      (function () {
        gsap.registerPlugin(ScrollTrigger);

        window.addEventListener("load", function () {
          // ---------- CRITICAL FIX: NO OVERLAPPING SHAPES ----------
          // Each shape appears only when its section is active, and fully disappears before next appears.
          // We use visibility + opacity to ensure only ONE shape is ever visible on the right side.

          // First, ensure all shapes start hidden (visibility: hidden, opacity: 0)
          const allShapes = document.querySelectorAll(".shape-container");
          gsap.set(allShapes, {
            opacity: 0,
            visibility: "hidden",
            y: 40,
            scale: 0.9,
          });

          // Define section-to-shape mapping with exclusive ranges
          const shapeConfigs = [
            {
              trigger: ".s1",
              shape: ".shape-1",
              start: "top bottom",
              end: "bottom top",
            },
            {
              trigger: ".s2",
              shape: ".shape-2",
              start: "top bottom",
              end: "bottom top",
            },
            {
              trigger: ".s3",
              shape: ".shape-3",
              start: "top bottom",
              end: "bottom top",
            },
            {
              trigger: ".s4",
              shape: ".shape-4",
              start: "top bottom",
              end: "bottom top",
            },
            {
              trigger: ".s5",
              shape: ".shape-5",
              start: "top bottom",
              end: "bottom top",
            },
            {
              trigger: ".s6",
              shape: ".shape-6",
              start: "top bottom",
              end: "bottom top",
            },
          ];

          // FIRST: kill any potential overlap by creating a master timeline for toggles?
          // Better: use callbacks to force hide others when one becomes visible.
          // We'll create separate ScrollTriggers but with a toggle function to enforce exclusivity.

          shapeConfigs.forEach((config, index) => {
            const shapeEl = document.querySelector(config.shape);
            if (!shapeEl) return;

            // Create a timeline that fades in the shape, then fades out
            // IMPORTANT: Ensure that when this shape fades in, we set visibility = visible.
            // And when it fades out, set visibility = hidden.

            // To prevent overlap, we add a callback on every animation update:
            // Whenever a shape becomes visible (opacity > 0), we force all OTHER shapes to hide instantly.

            ScrollTrigger.create({
              trigger: config.trigger,
              start: "top bottom",
              end: "bottom top",
              onUpdate: (self) => {
                // progress goes from 0 to 1 near middle, then back to 0
                // We want shape to be visible only in the inner 60% range to avoid edge overlaps
                const progress = self.progress;

                // map progress to opacity: fade in at start, fade out at end
                let opacity = 0;
                let visible = false;

                if (progress > 0.1 && progress < 0.9) {
                  // smooth entry/exit curve
                  if (progress < 0.3) {
                    opacity = (progress - 0.1) * 5; // 0 to 1 ramp
                  } else if (progress > 0.7) {
                    opacity = (0.9 - progress) * 5; // 1 to 0 ramp
                  } else {
                    opacity = 1;
                  }
                  visible = true;
                } else {
                  opacity = 0;
                  visible = false;
                }

                // ENFORCE EXCLUSIVITY: Before showing this shape, hide all others
                if (visible && opacity > 0.05) {
                  gsap.set(allShapes, {
                    opacity: 0,
                    visibility: "hidden",
                    immediateRender: true,
                  });
                }

                // Now set this shape with calculated opacity and visibility = visible
                gsap.set(shapeEl, {
                  opacity: opacity,
                  visibility: visible ? "visible" : "hidden",
                  y: 40 - progress * 80, // subtle vertical move
                  scale: 0.9 + progress * 0.2,
                  immediateRender: true,
                });
              },
              toggleActions: "play none none reverse",
            });

            // Also add a separate scrub timeline for smooth transform (optional)
            // but the onUpdate already handles it. However we want scrub feel.
            // We'll use a timeline with scrub for better fluidity but enforce exclusivity in onUpdate
            const tl = gsap.timeline({
              scrollTrigger: {
                trigger: config.trigger,
                start: "top bottom",
                end: "bottom top",
                scrub: 0.5,
                onUpdate: (self) => {
                  // This ensures exclusivity is maintained throughout scrub
                  const progress = self.progress;
                  if (progress > 0.1 && progress < 0.9) {
                    // hide all others
                    gsap.set(allShapes, { opacity: 0, visibility: "hidden" });
                    // ensure this shape is visible
                    gsap.set(shapeEl, { visibility: "visible" });
                  }
                },
              },
            });

            // from invisible to visible and back
            tl.fromTo(
              shapeEl,
              { opacity: 0, y: 40, scale: 0.9, visibility: "hidden" },
              {
                opacity: 1,
                y: 0,
                scale: 1,
                visibility: "visible",
                duration: 0.8,
                ease: "power2.out",
              },
              0,
            ).to(
              shapeEl,
              {
                opacity: 0,
                y: -40,
                scale: 1.1,
                visibility: "hidden",
                duration: 0.8,
                ease: "power2.in",
              },
              0.8, // starts after first part? Actually we need full scrub: we want progress 0->1 to map
            );
            // Override: simpler to just use onUpdate for exclusivity. We'll keep both but enforce set.
          });

          // Additional strong exclusivity enforcement: whenever any ScrollTrigger updates,
          // we make sure only the shape linked to the most active section is visible.
          // We'll add a "master" ScrollTrigger that watches all sections and hides non-matching shapes.

          // Hide all shapes initially
          gsap.set(allShapes, { opacity: 0, visibility: "hidden" });

          // Exclusive visibility controller
          function activateOnly(activeShape) {
            allShapes.forEach((shape) => {
              if (shape === activeShape) {
                gsap.set(shape, { visibility: "visible" });
              } else {
                gsap.set(shape, { visibility: "hidden", opacity: 0 });
              }
            });
          }

          // Set up each section to control its shape with strict exclusivity
          shapeConfigs.forEach((cfg) => {
            const shape = document.querySelector(cfg.shape);
            ScrollTrigger.create({
              trigger: cfg.trigger,
              start: "top 70%", // appear when section enters
              end: "bottom 30%", // disappear when section leaves
              onEnter: () => {
                gsap.set(allShapes, { opacity: 0, visibility: "hidden" });
                gsap.to(shape, {
                  opacity: 1,
                  visibility: "visible",
                  y: 0,
                  scale: 1,
                  duration: 0.6,
                  ease: "power2.out",
                });
              },
              onLeave: () => {
                gsap.to(shape, {
                  opacity: 0,
                  visibility: "hidden",
                  y: -40,
                  scale: 1.1,
                  duration: 0.5,
                  ease: "power2.in",
                });
              },
              onEnterBack: () => {
                gsap.set(allShapes, { opacity: 0, visibility: "hidden" });
                gsap.to(shape, {
                  opacity: 1,
                  visibility: "visible",
                  y: 0,
                  scale: 1,
                  duration: 0.6,
                  ease: "power2.out",
                });
              },
              onLeaveBack: () => {
                gsap.to(shape, {
                  opacity: 0,
                  visibility: "hidden",
                  y: 40,
                  scale: 0.9,
                  duration: 0.5,
                  ease: "power2.in",
                });
              },
            });
          });

          // ---------- TEXT ANIMATIONS (unchanged, cinematic) ----------
          document.querySelectorAll(".scroll-section").forEach((section) => {
            const focusText = section.querySelector(".focus-text");
            const desc = section.querySelector(".description");

            if (focusText) {
              gsap.fromTo(
                focusText,
                { opacity: 0, filter: "blur(12px)", scale: 0.8, y: 40 },
                {
                  opacity: 1,
                  filter: "blur(0px)",
                  scale: 1,
                  y: 0,
                  duration: 0.9,
                  ease: "power2.out",
                  scrollTrigger: {
                    trigger: section,
                    start: "top center",
                    end: "center center",
                    scrub: 0.5,
                    toggleActions: "play none none reverse",
                  },
                },
              );
              gsap.to(focusText, {
                opacity: 0,
                filter: "blur(12px)",
                scale: 0.95,
                y: -40,
                duration: 0.8,
                ease: "power2.in",
                scrollTrigger: {
                  trigger: section,
                  start: "center center",
                  end: "bottom top",
                  scrub: 0.5,
                  toggleActions: "play none none reverse",
                },
              });
            }

            if (desc) {
              gsap.fromTo(
                desc,
                {
                  opacity: 0,
                  filter: "blur(12px)",
                  scale: 0.8,
                  y: 40,
                  borderColor: "transparent",
                },
                {
                  opacity: 1,
                  filter: "blur(0px)",
                  scale: 1,
                  y: 0,
                  borderColor: "var(--accent)",
                  duration: 0.9,
                  ease: "power2.out",
                  scrollTrigger: {
                    trigger: section,
                    start: "top center",
                    end: "center center",
                    scrub: 0.5,
                    toggleActions: "play none none reverse",
                  },
                },
              );
              gsap.to(desc, {
                opacity: 0,
                filter: "blur(12px)",
                scale: 0.95,
                y: -40,
                borderColor: "transparent",
                duration: 0.8,
                ease: "power2.in",
                scrollTrigger: {
                  trigger: section,
                  start: "center center",
                  end: "bottom top",
                  scrub: 0.5,
                  toggleActions: "play none none reverse",
                },
              });
            }
          });

          // ---------- EXTRA POLISH (no overlap) ----------
          gsap.from("header .title-large", {
            scrollTrigger: {
              trigger: "header",
              start: "top top",
              end: "bottom center",
              scrub: 1,
            },
            scale: 0.95,
            opacity: 0.8,
            y: 20,
            filter: "blur(6px)",
            duration: 1,
          });

          gsap.from(".closer", {
            scrollTrigger: {
              trigger: ".closing-section",
              start: "top bottom",
              end: "center center",
              scrub: 0.8,
            },
            opacity: 0,
            y: 40,
            scale: 0.9,
            filter: "blur(8px)",
            duration: 1.2,
          });

          // Subtle movement for balance circles (only when shape-4 is active, but exclusivity prevents overlap anyway)
          const b1 = document.querySelector(".b-1");
          const b2 = document.querySelector(".b-2");
          if (b1 && b2) {
            gsap.to(b1, {
              scrollTrigger: {
                trigger: ".s4",
                start: "top bottom",
                end: "bottom top",
                scrub: 0.5,
              },
              x: -20,
              y: -20,
              duration: 1,
            });
            gsap.to(b2, {
              scrollTrigger: {
                trigger: ".s4",
                start: "top bottom",
                end: "bottom top",
                scrub: 0.5,
              },
              x: 20,
              y: 20,
              duration: 1,
            });
          }

          // Light orb pulse – only when visible (exclusivity ensures no overlap)
          const orb = document.querySelector(".light-orb");
          if (orb) {
            gsap.to(orb, {
              scrollTrigger: {
                trigger: ".s5",
                start: "top bottom",
                end: "bottom top",
                scrub: 0.8,
              },
              scale: 1.2,
              opacity: 0.8,
              filter: "blur(50px)",
              duration: 1.2,
            });
          }

          // Ensure all shapes are hidden at the very start
          gsap.set(allShapes, { opacity: 0, visibility: "hidden" });

          console.log(
            "✅ NO OVERLAP: shapes appear one by one with exclusivity",
          );
        });
      })();
    </script>

    <!-- 
    COMPLETE FIX: 
    - Shapes never overlap because we set visibility: hidden on all others before showing current.
    - Multiple ScrollTrigger strategies enforce exclusivity (onUpdate, onEnter/onLeave).
    - Desktop/mobile progress bars remain untouched and functional.
    - All original design, typography, and shapes preserved.
    - GSAP animations are smooth and non-conflicting.
  --></body>
</html>
